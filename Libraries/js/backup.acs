{"customEntities":{"script":[["1",{"value":{"mdTime":1707904075378,"srcCode":"// function extractAndCopyData() {\n//   // Select all div elements with the class \"tableRowGroupInner\"\n//   const divElements = document.querySelectorAll('div.tableRowGroupInner');\n\n//   if (divElements.length > 0) {\n//     let extractedData = '';\n//     // Loop through the matched div elements\n//     divElements.forEach((divElement) => {\n//       // Extracting data from the div and anchor elements\n//       const nameElement = divElement.querySelector('div.tableCell.col1')\n//       const detailsElement = divElement.querySelector('div.tableCell.col2')\n//       const totalElement = divElement.querySelector('div.tableCell.col3')\n//       const statusElement = divElement.querySelector('div.tableCell.col4')\n\n//       const detailsDateElement = detailsElement.querySelector('div.tableCellItem.doubleItemTop.stack')\n//       const detailsPaymentMethodElement = detailsElement.querySelector('div.tableCellItem.doubleItemBottom.stack')\n\n//       const name = nameElement.textContent.trim();\n//       const detailsDate = detailsDateElement.textContent.trim();\n//       const detailsPaymentMethod = detailsPaymentMethodElement.textContent.trim();\n//       const total = totalElement.textContent.trim();\n//       const status = statusElement.textContent.trim();\n\n//       // Append the extracted data to the result\n//       extractedData += `${name}\\t${detailsDate}\\t${detailsPaymentMethod}\\t${total}\\t${status}\\n`;\n//     });\n\n//     // Copy the data to the clipboard\n//     copyToClipboard(extractedData);\n\n//     console.log(\"Data has been extracted and copied to the clipboard.\");\n//   } else {\n//     console.log(\"No div elements with the specified class found.\");\n//   }\n// }\n\n// function copyToClipboard(text) {\n//   const textarea = document.createElement(\"textarea\");\n//   textarea.value = text;\n//   document.body.appendChild(textarea);\n//   textarea.select();\n//   document.execCommand(\"copy\");\n//   document.body.removeChild(textarea);\n// }\n\n\n\n///new\n\n\n// Select all div elements with the class \"tableRowGroupInner\"\n// navigator.permissions.query({ name: \"write-on-clipboard\" })\n// .then((result) => {\n//   if (result.state == \"granted\" || result.state == \"prompt\") {\n//     alert(\"Write access granted!\");\n//   }\n// })\n// .catch(error => { console.log(error) })\n\nconst divElements = document.querySelectorAll('div.tableRowGroupInner');\n\nif (divElements.length > 0) {\n  let extractedData = '';\n  // Loop through the matched div elements\n  divElements.forEach((divElement) => {\n    // Extracting data from the div and anchor elements\n    const name = divElement.querySelector('div.tableCell.col1').textContent.trim()\n    const total = divElement.querySelector('div.tableCell.col3').textContent.trim();\n    const status = divElement.querySelector('div.tableCell.col4').textContent.trim();\n    \n    const detailsElement = divElement.querySelector('div.tableCell.col2')\n    const detailsDate = detailsElement.querySelector('div.tableCellItem.doubleItemTop.stack').textContent.trim();\n    const detailsPaymentMethod = detailsElement.querySelector('div.tableCellItem.doubleItemBottom.stack').textContent.trim();\n\n    extractedData += `${name}\\t${detailsDate}\\t${detailsPaymentMethod}\\t${total}\\t${status}\\n`;\n  });\n\n  async function copyTextToClipboard(text) {\n    try {\n      await navigator.clipboard.writeText(text);\n      console.log('Text copied to clipboard');\n    } catch (err) {\n      console.error('Failed to copy: ', err);\n    }\n  }\n  await copyTextToClipboard(extractedData)\n}\nelse {\n  console.log(\"No div elements with the specified class found.\");\n}\n"}}],["2",{"value":{"mdTime":1707904276085,"srcCode":"alert(\"keep openssss\")\nsetInterval(() => {\n\n  const continueButton = document.querySelector('a.timeOutContinue');\n  if (continueButton) {\n    continueButton.click();\n  }\n}, 10000);\n"}}],["3",{"value":{"mdTime":1707904302072,"srcCode":"document.querySelectorAll('.shortCutLink')[0].click()"}}],["4",{"value":{"mdTime":1707904321797,"srcCode":"document.querySelectorAll('.shortCutLink')[2].click()"}}],["5",{"value":{"mdTime":1707904337358,"srcCode":"let ele = document.getElementsByClassName(\"eziLink btt_1 eziBtn1_eziLink   \")\n\nfor(let i = 0; i < ele.length; i++) {\n    ele[i].click()\n}"}}],["6",{"value":{"mdTime":1707904418404,"srcCode":"const tableContent = document.getElementById('AuthorisationsPaymentsTable_tableContent');\nconst allDivs = tableContent.querySelectorAll('div');\nconst matchingDivs = Array.from(allDivs).filter(div => div.id && div.id.match(/^tabelRow_\\d+$/));\n\nlet total = 0\nconst extractedData = matchingDivs.map(div => {\n  const payment = div.querySelector('.col1 a')?.textContent.trim() || '';\n  let amount = div.querySelector('.col3 #Total')?.textContent.trim() || ''; //returns string \"#,###.00\"\n\n  //need to strip comma and convert to float\n  amount = parseFloat(amount.replace(/,/g, ''));\n  total += amount\n  return { payment, amount };\n});\n\nfunction copyToClipboard(text) {\n  const textarea = document.createElement(\"textarea\");\n  textarea.value = text;\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(textarea);\n}\n\nlet data = 'Payment\\tAmount\\n'\nfor (let pmt of extractedData) {\n  data += `${pmt.payment}\\t${pmt.amount}\\n`\n}\ndata += `Total\\t${total}`\n\nconst textarea = document.createElement(\"textarea\");\ntextarea.value = data;\ndocument.body.appendChild(textarea);\ntextarea.select();\ndocument.execCommand(\"copy\");\ndocument.body.removeChild(textarea);"}}],["7",{"value":{"mdTime":1707904587452,"srcCode":"document.getElementById(\"tableSwitcherButton_3\").click()"}}],["8",{"value":{"mdTime":1707904532299,"srcCode":"document.getElementById(\"tableSwitcherButton_2\").click()"}}],["9",{"name":"","value":{"mdTime":1709624159447,"srcCode":"document.getElementById(\"tableActionButtons\").getElementsByClassName(\"searchButton\")[0].click()"}}]]},"mouseGest":{},"trigActList":[["9",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:9"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":186,"preconds":[{"keyEvt":17},{"keyEvt":16}],"wildcard":2}]}]}],["7",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:7"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":221,"preconds":[{"keyEvt":162},{"keyEvt":160}],"wildcard":2}]}]}],["8",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:8"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":219,"preconds":[{"keyEvt":17},{"keyEvt":16}],"wildcard":2}]}]}],["6",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:6"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":69,"preconds":[{"keyEvt":17},{"keyEvt":18}],"wildcard":2}]}]}],["5",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:5"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":83,"preconds":[{"keyEvt":16},{"keyEvt":17}],"wildcard":2}]}]}],["4",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:4"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":80,"preconds":[{"keyEvt":17},{"keyEvt":16}],"wildcard":2}]}]}],["3",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:3"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":65,"preconds":[{"keyEvt":17},{"keyEvt":16}],"wildcard":2}]}]}],["2",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:2"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":79,"preconds":[{"keyEvt":17},{"keyEvt":16}],"wildcard":2}]}]}],["1",{"actions":[{"sequence":[{"action":"runScript","params":{"scriptId":"script:1"}}],"targets":"currentTab"}],"triggers":[{"combins":[{"block":1,"eventId":69,"preconds":[{"keyEvt":16},{"keyEvt":17}],"wildcard":2}]}]}]],"userVars":{}}